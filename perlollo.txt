CREATE TABLE import_corsi_2023 (
    annoaccademico          varchar(255),
    immatricolabile         varchar(255),
    corso_codice            varchar(255),
    corso_descrizione       varchar(255),
    url                     varchar(255),
    campus                  varchar(255),
    sededidattica           varchar(255),
    ambiti                  varchar(255),
    tipologia               varchar(255),
    durata                  varchar(255),
    internazionale          varchar(255),
    internazionale_titolo   varchar(255),
    internazionale_lingua   varchar(255),
    lingue                  varchar(255),
    accesso                 varchar(255)
);




LOAD DATA INFILE '/percorso/assoluto/corsi_2023_it.csv'
INTO TABLE import_corsi_2023
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 LINES;



CREATE TABLE import_insegnanti (
    annoaccademico      varchar(255),
    corso_codice        varchar(255),
    materia_codice      varchar(255),
    materia_descrizione varchar(255),
    url                 varchar(255),
    tipo                varchar(255),
    docente_codice      varchar(255),
    docente_nome        varchar(255),
    lingua              varchar(255),
    `e-learning`        varchar(255),
    componente_id       varchar(255),
    componente_padre    varchar(255),
    componente_radice   varchar(255),
    componente_mutuazione varchar(255)
);


CREATE TABLE import_docenti (
    docente_codice  varchar(255),
    docente_nome    varchar(255)
);


INSERT INTO CORSO_DI_LAUREA (Codice, Nome, Campus, Ambito, Tipologia, Lingua)
SELECT
  corso_codice,
  corso_descrizione,
  campus,
  ambiti,
  tipologia,
  lingue
FROM import_corsi_2023;



INSERT INTO PROFESSORE (Codice, Nome)
SELECT DISTINCT docente_codice, docente_nome
FROM import_docenti;



INSERT INTO INSEGNAMENTO (Codice, Nome, Lingua, Corso_di_laurea)
SELECT DISTINCT
  materia_codice,
  materia_descrizione,
  lingua,
  corso_codice
FROM import_insegnanti;



INSERT INTO Tenere (Insegnamento, Professore)
SELECT DISTINCT
  materia_codice,
  docente_codice
FROM import_insegnanti;

